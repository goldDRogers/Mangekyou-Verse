{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/joshi/.gemini/antigravity/scratch/mangekyou-verse-frontend/components/AnimeCard.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React from 'react';\r\nimport Link from 'next/link';\r\nimport { Anime } from '../types';\r\n\r\ninterface AnimeCardProps {\r\n  anime: Anime;\r\n}\r\n\r\nconst AnimeCard: React.FC<AnimeCardProps> = ({ anime }) => {\r\n  return (\r\n    <Link href={`/watch/${anime.id}`} className=\"group block relative animate-slide-up\">\r\n      <div className=\"relative aspect-[3/4] overflow-hidden rounded-xl bg-brand-card border border-white/5 group-hover:border-brand-accent/50 transition-all duration-300\">\r\n        <img\r\n          src={anime.thumbnail}\r\n          alt={anime.title}\r\n          className=\"w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-500\"\r\n          loading=\"lazy\"\r\n        />\r\n\r\n        {/* Badges */}\r\n        <div className=\"absolute top-2 left-2 flex flex-col gap-1 z-10\">\r\n          <span className=\"bg-brand-accent text-white text-[10px] font-bold px-1.5 py-0.5 rounded uppercase\">\r\n            {anime.type}\r\n          </span>\r\n          <span className=\"bg-black/80 text-white text-[10px] font-bold px-1.5 py-0.5 rounded uppercase\">\r\n            Ep {anime.episodes}\r\n          </span>\r\n        </div>\r\n\r\n        {/* Rating */}\r\n        <div className=\"absolute top-2 right-2 z-10\">\r\n          <span className=\"bg-yellow-500/90 text-black text-[10px] font-bold px-1.5 py-0.5 rounded flex items-center gap-1\">\r\n            <i className=\"fa-solid fa-star\"></i>\r\n            {anime.rating}\r\n          </span>\r\n        </div>\r\n\r\n        {/* Overlay */}\r\n        <div className=\"absolute inset-0 bg-gradient-to-t from-black/90 via-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col justify-end p-4\">\r\n          <div className=\"bg-brand-accent text-white rounded-full w-10 h-10 flex items-center justify-center self-center mb-4 translate-y-4 group-hover:translate-y-0 transition-transform duration-300\">\r\n            <i className=\"fa-solid fa-play text-lg\"></i>\r\n          </div>\r\n          <div className=\"flex flex-wrap gap-1 mt-2\">\r\n            {anime.genres.slice(0, 2).map(genre => (\r\n              <span key={genre} className=\"text-[10px] bg-white/10 px-2 py-0.5 rounded-full text-white/80\">\r\n                {genre}\r\n              </span>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"mt-3\">\r\n        <h3 className=\"text-sm font-bold text-gray-100 group-hover:text-brand-accent transition-colors line-clamp-1\">\r\n          {anime.title}\r\n        </h3>\r\n        <p className=\"text-[11px] text-gray-500 mt-1\">\r\n          {anime.status} â€¢ {anime.type}\r\n        </p>\r\n      </div>\r\n    </Link>\r\n  );\r\n};\r\n\r\nexport default AnimeCard;\r\n"],"names":[],"mappings":";;;;;AAGA;AAHA;;;AAUA,MAAM,YAAsC,CAAC,EAAE,KAAK,EAAE;IACpD,qBACE,8OAAC,uKAAI;QAAC,MAAM,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;QAAE,WAAU;;0BAC1C,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,KAAK,MAAM,SAAS;wBACpB,KAAK,MAAM,KAAK;wBAChB,WAAU;wBACV,SAAQ;;;;;;kCAIV,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAK,WAAU;0CACb,MAAM,IAAI;;;;;;0CAEb,8OAAC;gCAAK,WAAU;;oCAA+E;oCACzF,MAAM,QAAQ;;;;;;;;;;;;;kCAKtB,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BAAK,WAAU;;8CACd,8OAAC;oCAAE,WAAU;;;;;;gCACZ,MAAM,MAAM;;;;;;;;;;;;kCAKjB,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC;oCAAE,WAAU;;;;;;;;;;;0CAEf,8OAAC;gCAAI,WAAU;0CACZ,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC,CAAA,sBAC5B,8OAAC;wCAAiB,WAAU;kDACzB;uCADQ;;;;;;;;;;;;;;;;;;;;;;0BAQnB,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCACX,MAAM,KAAK;;;;;;kCAEd,8OAAC;wBAAE,WAAU;;4BACV,MAAM,MAAM;4BAAC;4BAAI,MAAM,IAAI;;;;;;;;;;;;;;;;;;;AAKtC;uCAEe"}},
    {"offset": {"line": 288, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/joshi/.gemini/antigravity/scratch/mangekyou-verse-frontend/services/geminiService.ts"],"sourcesContent":["import { GoogleGenAI, Type } from \"@google/genai\";\r\nimport { Anime } from \"../types\";\r\n\r\nconst CACHE_KEY = 'mangekyou_anime_cache';\r\nconst CACHE_EXPIRY = 1000 * 60 * 60; // 1 hour\r\n\r\nconst getApiKey = () => {\r\n  try {\r\n    return (process.env.NEXT_PUBLIC_GEMINI_API_KEY) ||\r\n      (process.env.GEMINI_API_KEY) ||\r\n      // @ts-ignore\r\n      (import.meta.env?.VITE_GEMINI_API_KEY) ||\r\n      '';\r\n  } catch (e) {\r\n    return '';\r\n  }\r\n};\r\n\r\nconst getAIClient = () => {\r\n  const key = getApiKey();\r\n  if (!key) return null;\r\n  try {\r\n    // For @google/genai v1.34.0, the constructor takes an object or just the key depending on version\r\n    // Based on previous working code, it expects an object with apiKey\r\n    return new GoogleGenAI({ apiKey: key });\r\n  } catch (e) {\r\n    console.error(\"Failed to initialize GoogleGenAI\", e);\r\n    return null;\r\n  }\r\n};\r\n\r\nconst ai = getAIClient();\r\n\r\nexport const generateAnimeList = async (count: number = 8): Promise<Anime[]> => {\r\n  // Graceful fallback if API fails\r\n  const mockData = Array.from({ length: count }).map((_, i) => ({\r\n    id: `mock-id-${i}`,\r\n    title: `Anime Title ${i + 1}`,\r\n    description: \"This is a fallback description because the AI service is currently unavailable or the quota has been exceeded. Please check back in an hour or add your own Gemini API key.\",\r\n    rating: (Math.random() * 5 + 5).toFixed(1),\r\n    episodes: 12 + i,\r\n    type: 'TV',\r\n    status: 'Finished',\r\n    genres: ['Action', 'Fantasy'],\r\n    thumbnail: `https://loremflickr.com/800/1200/anime,girl,scenery/all?lock=${i}`,\r\n    gallery: [\r\n      `https://loremflickr.com/1280/720/anime,background,scenery/all?lock=${i + 10}`,\r\n      `https://loremflickr.com/1280/720/anime,fight,action/all?lock=${i + 20}`,\r\n      `https://loremflickr.com/1280/720/anime,city,night/all?lock=${i + 30}`\r\n    ]\r\n  })) as unknown as Anime[];\r\n\r\n  // 1. Check Cache first to save quota\r\n  if (typeof window !== 'undefined') {\r\n    try {\r\n      const cached = localStorage.getItem(CACHE_KEY);\r\n      if (cached) {\r\n        const { data, timestamp } = JSON.parse(cached);\r\n        if (Date.now() - timestamp < CACHE_EXPIRY && data.length >= count) {\r\n          console.log(\"Using cached anime list to save Gemini quota.\");\r\n          return data.slice(0, count);\r\n        }\r\n      }\r\n    } catch (e) {\r\n      console.warn(\"Failed to read from cache\", e);\r\n    }\r\n  }\r\n\r\n  try {\r\n    const key = getApiKey();\r\n    if (!ai || !key) {\r\n      console.warn(\"Gemini API Key missing. Using fallback data.\");\r\n      return mockData;\r\n    }\r\n\r\n    // Use the API pattern that was working before (ai.models.generateContent)\r\n    // @ts-ignore\r\n    const response = await ai.models.generateContent({\r\n      model: 'gemini-1.5-flash-latest', // Switched to -latest to fix v1beta 404\r\n      contents: [{ role: 'user', parts: [{ text: `Generate a list of 18 fictional anime titles with short descriptions, ratings, genres, types (TV, Movie, OVA, ONA, Special). Provide the data as a clean JSON array.` }] }],\r\n      config: {\r\n        responseMimeType: \"application/json\",\r\n        responseSchema: {\r\n          type: Type.ARRAY,\r\n          items: {\r\n            type: Type.OBJECT,\r\n            properties: {\r\n              id: { type: Type.STRING },\r\n              title: { type: Type.STRING },\r\n              description: { type: Type.STRING },\r\n              rating: { type: Type.NUMBER },\r\n              episodes: { type: Type.NUMBER },\r\n              type: { type: Type.STRING },\r\n              status: { type: Type.STRING },\r\n              genres: { type: Type.ARRAY, items: { type: Type.STRING } }\r\n            },\r\n            required: [\"id\", \"title\", \"description\", \"rating\", \"episodes\", \"type\", \"status\", \"genres\"]\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    // @ts-ignore\r\n    const data = JSON.parse(response.text || '[]');\r\n\r\n    const processedData = data.map((item: any, idx: number) => ({\r\n      ...item,\r\n      thumbnail: `https://loremflickr.com/800/1200/anime,cover/all?lock=${idx}`,\r\n      gallery: [\r\n        `https://loremflickr.com/1280/720/anime,scenery/all?lock=${idx + 100}`,\r\n        `https://loremflickr.com/1280/720/anime,character/all?lock=${idx + 200}`,\r\n        `https://loremflickr.com/1280/720/anime,scene/all?lock=${idx + 300}`\r\n      ]\r\n    }));\r\n\r\n    // 2. Save to Cache\r\n    if (typeof window !== 'undefined') {\r\n      localStorage.setItem(CACHE_KEY, JSON.stringify({\r\n        data: processedData,\r\n        timestamp: Date.now()\r\n      }));\r\n    }\r\n\r\n    return processedData;\r\n  } catch (error: any) {\r\n    // Graceful handling of common 429 quota errors\r\n    if (error?.message?.includes('429') || error?.message?.includes('quota') || error?.status === 429) {\r\n      console.error(\"Gemini Quota Exceeded. Switching to fallback data...\");\r\n    } else {\r\n      console.error(\"Error generating anime list:\", error);\r\n    }\r\n    return mockData;\r\n  }\r\n};\r\n\r\nexport const generateThumbnail = async (prompt: string): Promise<string | null> => {\r\n  try {\r\n    if (!ai) return null;\r\n    // @ts-ignore\r\n    const response = await ai.models.generateContent({\r\n      model: 'gemini-1.5-flash-latest',\r\n      contents: [{ role: 'user', parts: [{ text: `High quality anime style illustration for: ${prompt}` }] }]\r\n    });\r\n\r\n    // @ts-ignore\r\n    const candidates = response.candidates || [];\r\n    for (const part of candidates[0]?.content?.parts || []) {\r\n      if (part.inlineData) {\r\n        return `data:image/png;base64,${part.inlineData.data}`;\r\n      }\r\n    }\r\n    // Fallback if no image is returned\r\n    return `https://picsum.photos/seed/${encodeURIComponent(prompt)}/400/600`;\r\n  } catch (error) {\r\n    console.error(\"Error generating thumbnail:\", error);\r\n    return null;\r\n  }\r\n};\r\n\r\nexport const searchAnime = async (query: string, count: number = 12): Promise<Anime[]> => {\r\n  try {\r\n    const key = getApiKey();\r\n    if (!ai || !key) {\r\n      console.warn(\"Gemini API Key missing. Using fallback data for search.\");\r\n      return generateAnimeList(count);\r\n    }\r\n\r\n    // @ts-ignore\r\n    const response = await ai.models.generateContent({\r\n      model: 'gemini-1.5-flash-latest',\r\n      contents: [{\r\n        role: 'user',\r\n        parts: [{ text: `Search for anime related to \"${query}\". Generate ${count} fictional anime titles that would match this search term, with short descriptions, ratings, genres, types (TV, Movie, OVA, ONA, Special). Provide the data as a clean JSON array.` }]\r\n      }],\r\n      config: {\r\n        responseMimeType: \"application/json\",\r\n        responseSchema: {\r\n          type: Type.ARRAY,\r\n          items: {\r\n            type: Type.OBJECT,\r\n            properties: {\r\n              id: { type: Type.STRING },\r\n              title: { type: Type.STRING },\r\n              description: { type: Type.STRING },\r\n              rating: { type: Type.NUMBER },\r\n              episodes: { type: Type.NUMBER },\r\n              type: { type: Type.STRING },\r\n              status: { type: Type.STRING },\r\n              genres: { type: Type.ARRAY, items: { type: Type.STRING } }\r\n            },\r\n            required: [\"id\", \"title\", \"description\", \"rating\", \"episodes\", \"type\", \"status\", \"genres\"]\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    // @ts-ignore\r\n    const data = JSON.parse(response.text || '[]');\r\n\r\n    return data.map((item: any, idx: number) => ({\r\n      ...item,\r\n      thumbnail: `https://loremflickr.com/800/1200/anime,search/all?lock=${idx}`,\r\n      gallery: [\r\n        `https://loremflickr.com/1280/720/anime,scenery/all?lock=${idx + 400}`,\r\n        `https://loremflickr.com/1280/720/anime,action/all?lock=${idx + 500}`,\r\n        `https://loremflickr.com/1280/720/anime,art/all?lock=${idx + 600}`\r\n      ]\r\n    }));\r\n  } catch (error: any) {\r\n    console.error(\"Error searching anime:\", error);\r\n    return generateAnimeList(count);\r\n  }\r\n};\r\n\r\nexport const getAnimeDetails = async (id: string): Promise<Anime | null> => {\r\n  // 1. Check Cache first\r\n  if (typeof window !== 'undefined') {\r\n    try {\r\n      const cached = localStorage.getItem(CACHE_KEY);\r\n      if (cached) {\r\n        const { data } = JSON.parse(cached);\r\n        const anime = data.find((a: Anime) => a.id === id);\r\n        if (anime) return anime;\r\n      }\r\n    } catch (e) {\r\n      console.warn(\"Failed to read from cache\", e);\r\n    }\r\n  }\r\n\r\n  // 2. If not in cache, generate details\r\n  try {\r\n    const key = getApiKey();\r\n    if (!ai || !key) return null;\r\n\r\n    // @ts-ignore\r\n    const response = await ai.models.generateContent({\r\n      model: 'gemini-1.5-flash-latest',\r\n      contents: [{\r\n        role: 'user',\r\n        parts: [{ text: `Generate detailed information for a fictional anime with ID \"${id}\". Provide title, description, rating, episodes, type, status, and genres as a clean JSON object.` }]\r\n      }],\r\n      config: {\r\n        responseMimeType: \"application/json\",\r\n        responseSchema: {\r\n          type: Type.OBJECT,\r\n          properties: {\r\n            id: { type: Type.STRING },\r\n            title: { type: Type.STRING },\r\n            description: { type: Type.STRING },\r\n            rating: { type: Type.NUMBER },\r\n            episodes: { type: Type.NUMBER },\r\n            type: { type: Type.STRING },\r\n            status: { type: Type.STRING },\r\n            genres: { type: Type.ARRAY, items: { type: Type.STRING } }\r\n          },\r\n          required: [\"id\", \"title\", \"description\", \"rating\", \"episodes\", \"type\", \"status\", \"genres\"]\r\n        }\r\n      }\r\n    });\r\n\r\n    // @ts-ignore\r\n    const data = JSON.parse(response.text || '{}');\r\n    return {\r\n      ...data,\r\n      thumbnail: `https://loremflickr.com/800/1200/anime,main/all?lock=${id.length}`,\r\n      gallery: [\r\n        `https://loremflickr.com/1280/720/anime,wallpaper/all?lock=${id.length + 10}`,\r\n        `https://loremflickr.com/1280/720/anime,screenshot/all?lock=${id.length + 20}`,\r\n        `https://loremflickr.com/1280/720/anime,scene/all?lock=${id.length + 30}`\r\n      ]\r\n    };\r\n  } catch (error) {\r\n    console.error(\"Error fetching anime details:\", error);\r\n    return null;\r\n  }\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 670, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/joshi/.gemini/antigravity/scratch/mangekyou-verse-frontend/services/api.ts"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst api = axios.create({\r\n    baseURL: '',\r\n    headers: {\r\n        'Content-Type': 'application/json'\r\n    }\r\n});\r\n\r\napi.interceptors.request.use(\r\n    (config) => {\r\n        const token = localStorage.getItem('token');\r\n        if (token) {\r\n            config.headers.Authorization = `Bearer ${token}`;\r\n        }\r\n        return config;\r\n    },\r\n    (error) => Promise.reject(error)\r\n);\r\n\r\nexport default api;\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,MAAM,gJAAK,CAAC,MAAM,CAAC;IACrB,SAAS;IACT,SAAS;QACL,gBAAgB;IACpB;AACJ;AAEA,IAAI,YAAY,CAAC,OAAO,CAAC,GAAG,CACxB,CAAC;IACG,MAAM,QAAQ,aAAa,OAAO,CAAC;IACnC,IAAI,OAAO;QACP,OAAO,OAAO,CAAC,aAAa,GAAG,CAAC,OAAO,EAAE,OAAO;IACpD;IACA,OAAO;AACX,GACA,CAAC,QAAU,QAAQ,MAAM,CAAC;uCAGf"}},
    {"offset": {"line": 694, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/joshi/.gemini/antigravity/scratch/mangekyou-verse-frontend/app/search/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useState, useEffect, Suspense } from 'react';\r\nimport { useSearchParams } from 'next/navigation';\r\nimport Layout from '@/components/Layout';\r\nimport AnimeCard from '@/components/AnimeCard';\r\nimport { searchAnime as searchGemini } from '@/services/geminiService';\r\nimport api from '@/services/api';\r\nimport { Anime } from '@/types';\r\nimport { motion } from 'framer-motion';\r\n\r\nfunction SearchResults() {\r\n    const searchParams = useSearchParams();\r\n    const query = searchParams ? searchParams.get('q') || '' : '';\r\n    const [results, setResults] = useState<Anime[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        const fetchResults = async () => {\r\n            if (!query) {\r\n                setLoading(false);\r\n                return;\r\n            }\r\n            setLoading(true);\r\n            try {\r\n                let data: Anime[] = [];\r\n                try {\r\n                    const response = await api.get(`/api/anime/search?q=${query}`);\r\n                    data = response.data;\r\n                } catch (e) {\r\n                    console.warn(\"Backend search failed, using Gemini.\", e);\r\n                }\r\n\r\n                if (!data || data.length === 0) {\r\n                    data = await searchGemini(query);\r\n                }\r\n                setResults(data);\r\n            } catch (err) {\r\n                console.error(\"Search failed\", err);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n        fetchResults();\r\n    }, [query]);\r\n\r\n    return (\r\n        <div className=\"container mx-auto px-4 py-12\">\r\n            <div className=\"mb-12\">\r\n                <h1 className=\"text-3xl font-black uppercase tracking-tighter mb-2\">\r\n                    Search Results <span className=\"text-brand-primary\">For:</span>\r\n                </h1>\r\n                <p className=\"text-gray-400 text-lg\">\"{query}\"</p>\r\n            </div>\r\n\r\n            {loading ? (\r\n                <div className=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-6\">\r\n                    {Array.from({ length: 12 }).map((_, i) => (\r\n                        <div key={i} className=\"aspect-[2/3] bg-white/5 rounded-xl animate-pulse\"></div>\r\n                    ))}\r\n                </div>\r\n            ) : results.length > 0 ? (\r\n                <div className=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-6\">\r\n                    {results.map((anime, index) => (\r\n                        <motion.div\r\n                            key={anime.id}\r\n                            initial={{ opacity: 0, y: 20 }}\r\n                            animate={{ opacity: 1, y: 0 }}\r\n                            transition={{ delay: index * 0.05 }}\r\n                        >\r\n                            <AnimeCard anime={anime} />\r\n                        </motion.div>\r\n                    ))}\r\n                </div>\r\n            ) : (\r\n                <div className=\"text-center py-24 bg-white/5 rounded-3xl border border-white/5\">\r\n                    <i className=\"fa-solid fa-face-frown text-6xl text-brand-primary/20 mb-6\"></i>\r\n                    <h2 className=\"text-2xl font-bold mb-2\">No results found</h2>\r\n                    <p className=\"text-gray-500\">Try searching for something else or check your spelling.</p>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default function SearchPage() {\r\n    return (\r\n        <Suspense fallback={\r\n            <div className=\"flex items-center justify-center min-h-[60vh]\">\r\n                <div className=\"w-12 h-12 border-4 border-brand-primary border-t-transparent rounded-full animate-spin\"></div>\r\n            </div>\r\n        }>\r\n            <SearchResults />\r\n        </Suspense>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AACA;AACA;AAEA;AATA;;;;;;;;AAWA,SAAS;IACL,MAAM,eAAe,IAAA,qJAAe;IACpC,MAAM,QAAQ,eAAe,aAAa,GAAG,CAAC,QAAQ,KAAK;IAC3D,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAU,EAAE;IAClD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,IAAA,kNAAS,EAAC;QACN,MAAM,eAAe;YACjB,IAAI,CAAC,OAAO;gBACR,WAAW;gBACX;YACJ;YACA,WAAW;YACX,IAAI;gBACA,IAAI,OAAgB,EAAE;gBACtB,IAAI;oBACA,MAAM,WAAW,MAAM,0HAAG,CAAC,GAAG,CAAC,CAAC,oBAAoB,EAAE,OAAO;oBAC7D,OAAO,SAAS,IAAI;gBACxB,EAAE,OAAO,GAAG;oBACR,QAAQ,IAAI,CAAC,wCAAwC;gBACzD;gBAEA,IAAI,CAAC,QAAQ,KAAK,MAAM,KAAK,GAAG;oBAC5B,OAAO,MAAM,IAAA,wIAAY,EAAC;gBAC9B;gBACA,WAAW;YACf,EAAE,OAAO,KAAK;gBACV,QAAQ,KAAK,CAAC,iBAAiB;YACnC,SAAU;gBACN,WAAW;YACf;QACJ;QACA;IACJ,GAAG;QAAC;KAAM;IAEV,qBACI,8OAAC;QAAI,WAAU;;0BACX,8OAAC;gBAAI,WAAU;;kCACX,8OAAC;wBAAG,WAAU;;4BAAsD;0CACjD,8OAAC;gCAAK,WAAU;0CAAqB;;;;;;;;;;;;kCAExD,8OAAC;wBAAE,WAAU;;4BAAwB;4BAAE;4BAAM;;;;;;;;;;;;;YAGhD,wBACG,8OAAC;gBAAI,WAAU;0BACV,MAAM,IAAI,CAAC;oBAAE,QAAQ;gBAAG,GAAG,GAAG,CAAC,CAAC,GAAG,kBAChC,8OAAC;wBAAY,WAAU;uBAAb;;;;;;;;;uBAGlB,QAAQ,MAAM,GAAG,kBACjB,8OAAC;gBAAI,WAAU;0BACV,QAAQ,GAAG,CAAC,CAAC,OAAO,sBACjB,8OAAC,oMAAM,CAAC,GAAG;wBAEP,SAAS;4BAAE,SAAS;4BAAG,GAAG;wBAAG;wBAC7B,SAAS;4BAAE,SAAS;4BAAG,GAAG;wBAAE;wBAC5B,YAAY;4BAAE,OAAO,QAAQ;wBAAK;kCAElC,cAAA,8OAAC,mIAAS;4BAAC,OAAO;;;;;;uBALb,MAAM,EAAE;;;;;;;;;qCAUzB,8OAAC;gBAAI,WAAU;;kCACX,8OAAC;wBAAE,WAAU;;;;;;kCACb,8OAAC;wBAAG,WAAU;kCAA0B;;;;;;kCACxC,8OAAC;wBAAE,WAAU;kCAAgB;;;;;;;;;;;;;;;;;;AAKjD;AAEe,SAAS;IACpB,qBACI,8OAAC,iNAAQ;QAAC,wBACN,8OAAC;YAAI,WAAU;sBACX,cAAA,8OAAC;gBAAI,WAAU;;;;;;;;;;;kBAGnB,cAAA,8OAAC;;;;;;;;;;AAGb"}}]
}